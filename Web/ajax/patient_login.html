<html>

<head>
    <title>登录</title>
    <link rel="stylesheet" type="text/css" href="patient_log_reg.css">
</head>

<body>
    <div class="logBox">
        <h2>用户登录</h2>
        <div class="rows">
            <span>手机号：</span><input id="user_num" onblur="checkNum()" type="text">
            <p id="msg1"></p>
        </div>
        <div class="rows">
            <span>密码：</span><input id="pwd" onblur="checkPwd()" type="text">
            <p id="msg2">密码6~12位，可以是数字、字母或_</p>
        </div>
        <button onclick="patientLog()">登录</button>
        <div id="logRes"></div>
    </div>


    <script>
        function patientLog() {
            // 1.创建异步对象
            var xhr = new XMLHttpRequest();
            console.log(xhr);
            // 4.绑定监听，获取响应
            xhr.onreadystatechange = function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var resTxt = xhr.responseText;
                    logRes.innerHTML = resTxt;
                    // console.log(resTxt);
                }
            }
            var url = `/patient/login?user_num=${user_num.value}&pwd=${pwd.value}`;
            // 3.打开连接，创建请求
            xhr.open("get", url, true);

            // 4.发送请求
            xhr.send(null);
        }

        function checkNum() {
            msg1.innerHTML = '';
            var reg = /^1[3-8]\d{9}$/;
            var arr = user_num.value.match(reg);
            if (arr == null) {
                msg1.innerHTML = '格式错误，请重新输入！';
            }
        }

        function checkPwd() {
            msg2.innerHTML = "";
            var reg = /^\w{6,12}$/;
            var arr = pwd.value.match(reg);
            if (arr == null) {
                msg2.innerHTML = "格式错误，请重新输入!";
            }
        }
    </script>
</body>

</html>